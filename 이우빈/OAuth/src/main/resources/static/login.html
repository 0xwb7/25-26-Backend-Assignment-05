<!doctype html>
<html lang="ko">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <link rel="stylesheet" href="/css/app.css">
    <title>로그인</title>
</head>
<body>
<h1>로그인</h1>
<nav><a href="/index.html">홈</a></nav>

<section>
    <h3>로컬 로그인</h3>
    <label>이메일 <input id="email" type="email"></label><br>
    <label>비밀번호 <input id="pw" type="password"></label><br>
    <button id="login">로그인</button>
</section>

<section>
    <h3>소셜 로그인</h3>
</section>

<h3>응답</h3>
<pre id="out"></pre>

<script src="/js/api.js"></script>
<script>
    document.querySelector('#login').onclick = async () => {
        const email = document.querySelector('#email').value.trim();
        const password = document.querySelector('#pw').value;
        const r = await AppAPI.api('/auth/login', {method: 'POST', body: {email, password}});
        AppAPI.out(r);
        if (r.status === 200 && r.json) {
            AppAPI.setAccessToken(r.json.accessToken || null);
            location.href = '/index.html';
        }
    };
</script>
</body>
</html>
